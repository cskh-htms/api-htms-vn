
<% if( typeof title == 'string' && title){ title = title } else{ title="" } %>


<% include ../../masterpage/loader %>

<script src="../../../../../<%= js_css_version %>/javascripts/class-option-speciality.js"></script>	

<% menu_taget = "sidebar_option" %>

<div id="page_wrap" class="page_wrap">
<div id="layout" class="page_width layout">
<div id="content-wrap" class="content_wrap">
<!-- --------------------
page wrap 
--------------------- -->
<% include ../../masterpage/header %>



<!-- --------------------
content
--------------------- -->
<div id="content" class="content">

	<h1><a href="/stores/manage/<%= store_id %>/<%= user_id %>"><%= store_name %></a><i class="fas fa-chevron-right"></i>
	<a href="/options/speciality/<%= store_id %>">Tùy chọn</a><i class="fas fa-chevron-right"></i>Tạo tùy chọn</h1>
	
	<div class="pro_content_edit">
		<div class="pro_col01">
			<div class="pro_box ten_sp_box">
				<h3>Tên tùy chọn</h3>
				<div class="inside">
					<input type="text" class= "" value="" id="options_product_speciality_name"/>
				</div>
			</div>
			
			<div class="pro_box">
				<h3>Lời nhắn từ admin</h3>
				<div class="inside">
					<textarea id="options_product_speciality_qoute"  rows="10" cols="100%" ></textarea>
				</div>
			</div>	
		</div>
		<div class="pro_col02">
			<!-- ------------------
			//option cha
			------------------- -->
			<div id="category_general_wrap" class="value_row pro_box">
				<h3>Tùy chọn cha</h3>
				<div id="category_general_box" class="inside">
					<select name="category_general" id="options_product_speciality_parent_id"  >
						<% include ../../masterpage/widget-option-check-box %>
					</select>
				</div>
			</div>
			
			<!--
			<div class="pro_box">
				<h3>Trạng thái cửa hàng</h3>
				<div class="inside">
					<select id="options_product_speciality_status_stores">
						<%- ojs_share.show_status_product() %>
					</select>
				</div>
			</div>
			-->
		</div>
	</div>
	
	
	


	<!-- ------------------
	//hình đại diện 
	------------------- -->
	<div class="pro_box" style="display: none">
		<h3>Ảnh đại diện</h3>	
		<div class="inside">
			<input type="text" value="" id="featured_image" data_value="" style="display:none;" />
			<input type="button" value="Thêm ảnh" id="btn_featured_image">
			<div id="img_box_dai_dien"></div>
			<input type='file' accept="image/*" id='upload_image' style="display:none;">
		</div>
	</div>
	<!-- ------------------
	//end of hình đại diện 
	------------------- -->

	<!-- ------------------
	thông tin danh mục
	------------------- -->
	<div class="value_row" style="display: none">
		<span>Mô tả tùy chọn</span>
		<textarea class="noi_dung"  id="noi_dung"  rows="20" cols="100%"></textarea>
	</div>
	<!-- ------------------
	//thông tin danh mục
	------------------- -->
	
	
	
	
		
	
	
	
	
	

<div class="btn_box">
	<a href="/options/speciality/<%= store_id %>/" class="btn_back">Quay về</a>
	<a href="/options/speciality/<%= store_id %>/" class="btn_back" id="btn_draf">Lưu & Ẩn</a>
	<button id="btn_save" class="btn_save">Đăng</button>
</div>	
	





<input type="hidden" id="user_id" value="<%= user_id %>"/>
<input type="hidden" id="store_id" value="<%= store_id %>"/>



</div>
<!-- --------------------
end content
--------------------- -->





<% include ../../masterpage/footer %>

</div><!-- //content_wrap -->	


<% include ../../masterpage/sidebar %>

<!-- --------------------
//end of page wrap 
--------------------- -->
</div><!-- //layout -->	
</div><!-- //pagewrap -->


<script>
$(document).ready(function($){
/////////////////////////////////////////////////////	
	//
	//@
	ojs_loader.loadTinyMCE('noi_dung');
	//
	//@
		
		
	
	//@
	ojs_loader.show_anh_dai_dien('featured_image','img_box_dai_dien',"","");
	//@
	//@
	
	//@
	$(document).on('click','#btn_featured_image',function(e) {		
		e.preventDefault();		
		$('#upload_image').trigger( "click" );
	});
	//@
	$("#upload_image").on("change",function(){
		let input = this;
		ojs_loader.upload_anh_dai_dien(input,"featured_image","img_box_dai_dien")
	});		
	//
	//xóa image dai dien
	$(document).on('click','.xoaAnhDaiDien',function(e) {		
		e.preventDefault();		
		
		// xoa image s3
		let products_speciality_featured_image = $('#featured_image').attr("data_value");
		let url = products_speciality_featured_image;
		
		//console.log(url);
		//return;
		
		
		ojs_loader.delete_s3(url);
		
		//$('#featured_image').attr("data_s3","");
		//xoa html
		$(this).parent(".img_box").remove();
		ojs_loader.set_value_anh_dai_dien('featured_image','img_box_dai_dien');
		
	});			
	//		
	//	
	
	
	//@
	//@
	//@
	//@
	var store_id = $('#store_id').val();		
	$(document).on('click','#btn_draf',function(e) {		
		e.preventDefault();
		var datas = get_datas();	
		
		datas.datas.options_product_speciality_status_stores = 0;
		
		//console.log(datas);
		//return;
		
		ojs_option_speciality.ajax_save(datas);	
	});
	
	//@
	//@
	//@
	//@
	$(document).on('click','#btn_save',function(e) {		
		e.preventDefault();
		var datas = get_datas();	
		datas.datas.options_product_speciality_status_stores = 1;
		//console.log(datas);
		//return;
		
		ojs_option_speciality.ajax_save(datas);	
	});


	
	
	function get_datas(){
		
		let options_product_speciality_name = $('#options_product_speciality_name').val();	
		//@
		//@
		let options_product_speciality_featured_image = $('#featured_image').attr('data_value');
		//@
		let options_product_speciality_parent_id = $('#options_product_speciality_parent_id  option:selected').val();
		//@
		let options_product_speciality_information = tinymce.get("noi_dung").getContent();
		
		let options_product_speciality_qoute = $('#options_product_speciality_qoute').val();
		//
				
		
		let datas = {
			"datas":{
				options_product_speciality_name : options_product_speciality_name,
				options_product_speciality_parent_id :  options_product_speciality_parent_id,
				options_product_speciality_information : options_product_speciality_information,
				options_product_speciality_featured_image : options_product_speciality_featured_image,
				options_product_speciality_qoute : options_product_speciality_qoute,
				options_product_speciality_stores_id : store_id
				
			}
		}
		
		return datas;
	}

	//
	//
///////////////////////////////////////////////////////
});//end of document
</script>



<% include ../../masterpage/loader-end %>
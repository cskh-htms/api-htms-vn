
<% if( typeof title == 'string' && title){ title = title } else{ title="" } %>
<% include ../../masterpage/loader %>


<div id="page_wrap" class="page_wrap">
<div id="layout" class="page_width layout">
<div id="content-wrap" class="content_wrap">
<!-- --------------------
page wrap 
--------------------- -->
<% include ../../masterpage/header %>

<script src="../../../../../<%= js_css_version %>/javascripts/class-discount-program-speciality.js"></script>	

<script>
	console.log(<%- JSON.stringify({"datas_info" : datas_info}) %>);
</script>	



<!-- --------------------
content
--------------------- -->
<div id="content" class="content">

	<h1><a href="/admin/">Admin</a><i class="fas fa-chevron-right"></i>Quản lý chương trình khuyến mãi</h1>


	<div class="sap_xep_loc">
		<div class="loc_wrap">
			<select id="loc_trang_thai">
				<option id="dis-new" value="[0]">Các chương trình mới tạo, cần phê duyệt</option>
				<option id="details-new" value="[0]">Cửa hàng yêu cầu tham gia chương trình cần phê duyệt </option>
				<option id="pro-new" value="[0]" selected >Sản phẩm yêu cầu tham gia chươgn trình, cần phê duyệt</option>
			</select>
		</div>
	</div>	
	
	
	<div id="ajax-wrap">	
		<% include ../../masterpage/widget-discount-program-show-admin-product-add %>
	</div>



<input type="hidden" id="user_id" value="<%= user_id %>"/>



</div>
<!-- --------------------
end content
--------------------- -->





<% include ../../masterpage/footer %>

</div><!-- //content_wrap -->	


<% include ../../masterpage/sidebar %>

<!-- --------------------
//end of page wrap 
--------------------- -->
</div><!-- //layout -->	
</div><!-- //pagewrap -->





<script>
$(document).ready(function($){
/////////////////////////////////////////////////////	
	
	//Loc trang thai
	///////////////////////////
	$("#loc_trang_thai").change(function() {
		let user_id = $('#user_id').val();
		var status_id = $('#loc_trang_thai  option:selected').attr('id');
		let status_admin = $('#loc_trang_thai').val();
		
		var datas = {
			"datas":{
				user_id 	: user_id,
				status_admin : JSON.parse(status_admin)
			}
		}	
		//console.log(datas);
		//return;
		//ojs_discount_program_speciality.ajax_load_discount_program(datas);	
		
		if(status_id == "dis-new"){
			location.href = "/discount-program/speciality/quan-ly";
		}else if(status_id == "details-new"){
			location.href = "/discount-program/speciality/store-active";
		}else if(status_id == "pro-new"){
			location.href = "/discount-program/speciality/product-active";			
		}	
		
		
	});
	
	
	//
	//@
	//xoa
	$(document).on('click','.submitdelete',function(e) {	
		//@
		e.preventDefault();		
		let discount_program_link_id = $(this).attr("data_discount_program_link_id");
		//
		//@
		let x = "xác nhận xoá";		
		let y = "delete_discount_program_link_id";//function name in callback 
		let z = ' { "discount_program_link_id" : "' + discount_program_link_id + '" }';
		ojs_message.message_yes_no_show(x,y,z);		
		//@
	});			
	
	
	//
	//@
	//xem
	$(document).on('click','.btn-xem',function(e) {	
		//@
		e.preventDefault();		
		var product_id = $(this).attr("data_product_id");
		ojs_discount_program_speciality.show_content_product(product_id);
		//@
	});		
	//
	//@
	//duyệt
	$(document).on('click','.btn-duyet',function(e) {	
		//@
		e.preventDefault();		
		var link_add_id = $(this).attr("data_product_add_id");
		//ojs_discount_program_speciality.add_product_to_discount(link_add_id);
		
		
		
				//@
		let x = "xác nhận phê duyệt";		
		let y = "discount_add";//function name in callback 
		let z = ' { "link_add_id" : "' + link_add_id + '"}';
		ojs_message.message_yes_no_show(x,y,z);	

		//@
	});		
	
	//
	//@
	//duyệt
	$(document).on('click','.btn-tu-choi',function(e) {	
		//@
		e.preventDefault();	
		var link_no_id = $(this).attr("data_product_no_id");
		let html = "" + 
		'<div class="ajax-box">' + 
			'<div class="ajax-box-inner">' + 
				'<h1> lý do từ chối</h1>' + 
				'<textarea rows="10" cols="50" id="tu-choi-content"></textarea>' + 
				'<div class="btn-tu-choi-go" style="text-align:right">' + 
					'<span id="btn-tu-choi-go" data_product_no_id="' + link_no_id + '" class="btn-design">save</span>' + 
				'</div>' + 
			'</div>';	
		'</div>';
		
		
		ojs_loadding.ajax_show_content( html);
		//@
	});		
	
	//
	//@
	//duyệt
	$(document).on('click','#btn-tu-choi-go',function(e) {	
		//@
		e.preventDefault();		
		var link_no_id = $(this).attr("data_product_no_id");
		var content = $('#tu-choi-content').val();
		
		var datas = {
			"datas": {   
				"discount_program_product_link_status" :"2",
				"discount_program_product_link_qoute":content
			}
		}
		
		
		//alert(content);
		//return;

		ojs_discount_program_speciality.no_product_to_discount(datas,link_no_id);
		//@
	});			
	
	//
///////////////////////////////////////////////////////
});//end of document
</script>








<% include ../../masterpage/loader-end %>